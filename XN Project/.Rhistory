table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("California", "California - CA")] <- "CA"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Colorado - CO")] <- "CO"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("10538")] <- "NY"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("33511")] <- "FL"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Connecticut")] <- "CT"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Florida", "Florida - FL")] <- "FL"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("District of Columbia - DC")] <- "DC"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Georgia - GA")] <- "GA"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Vermont - VT")] <- "VT"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Virginia - VA")] <- "VA"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Wisconsin")] <- "WI"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Texas - TX", "Texas")] <- "TX"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Tennessee - TN", "Texas")] <- "TN"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("South Carolina - SC")] <- "SC"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Pennsylvania - PA", "Pennsylvania")] <- "PA"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Ohio - OH", "Ohio")] <- "OH"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("New York - NY", "New York")] <- "NY"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("New Jersey - NJ", "New Jersey")] <- "NJ"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("New Hampshire")] <- "NH"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Nevada - NV")] <- "NV"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Mississippi")] <- "MS"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Michigan - MI", "Michigan")] <- "MI"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Louisiana - LA", "Louisiana")] <- "LA"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Illinois - IL", "Illinois")] <- "IL"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Idaho")] <- "ID"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Indiana - IN")] <- "IN"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Maryland - MD")] <- "MD"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("--")] <- "NA"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("7030")] <- "NA"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("BIHOR")] <- "NA"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("C")] <- "NA"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("No aplicable")] <- "NA"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("75062")] <- "TX"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("80122")] <- "CO"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("84332")] <- "UT"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("91356")] <- "CA"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Congo-Kinshasa")] <- "NA"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Greater London")] <- "NA"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Karnataka")] <- "NA"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("M")] <- "MN"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Nuevo LeÃ³n")] <- "NA"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Ontario")] <- "ON"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Orland Park")] <- "NA"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Queensland", "ROO")] <- "NA"
table(dataset$`Mailing State (Accounts)`)
dataset$`Mailing State (Accounts)`[dataset$`Mailing State (Accounts)` %in% c("Tokyo", "XX")] <- "NA"
table(dataset$`Mailing State (Accounts)`)
table(dataset$`Lead Source (Deals)`)
table(dataset$`Lead Sub Source (Deals)`)
table(dataset$`Customer Type`)
table(dataset$`Created Time (Deals)`)
table(dataset$`Created Time`)
table(dataset$`Client Inquiry (Deals)`)
table(dataset$Pipeline)
table(dataset$`Deal Name`)
table(dataset$`Sales Cycle Duration`)
table(dataset$`Overall Sales Duration`)
dataset$difference <- dataset$`Overall Sales Duration` - dataset$`Sales Cycle Duration`
summary(dataset$difference)  # Check min, max, mean difference
sum(dataset$difference > 0, na.rm = TRUE)
dataset[dataset$difference > 10, ]  # View rows where the difference is significant
sum(is.na(dataset$`Sales Cycle Duration`))
sum(is.na(dataset$`Overall Sales Duration`))
#Plotting for Indiviudal Project Proposal
library(dplyr)
dataset <- dataset %>%
mutate(
`Mailing Country (Accounts)` = ifelse(`Mailing State (Accounts)` %in% c("UK", "Australia", "Bahamas"),
`Mailing State (Accounts)`,
`Mailing Country (Accounts)`),
`Mailing State (Accounts)` = ifelse(`Mailing State (Accounts)` %in% c("UK", "Australia", "Bahamas"),
NA,
`Mailing State (Accounts)`)
)
library(dplyr)
dataset <- dataset %>%
mutate(
`Mailing State (Accounts)` = case_when(
`Mailing Zip` == 10031 ~ "NY",  # Assign NY for ZIP code 10031 (New York)
`Mailing Zip` == 50060 ~ "IA",  # Assign IA for ZIP code 50060 (Iowa)
TRUE ~ `Mailing State (Accounts)`  # Leave other rows unchanged
)
)
table(dataset$`Mailing State (Accounts)`)
library(ggplot2)
library(ggplot2)
# Create the data frame
state_counts <- data.frame(
State = c("AB", "AK", "AL", "AR", "AZ", "BC", "CA", "CO", "CT", "DC", "DE", "FL", "GA", "HI", "IA", "ID", "IL", "IN", "KS", "KY", "LA", "MA", "MB",
"MD", "ME", "MI", "MN", "MO", "MS", "MT", "NA", "NC", "ND", "NE", "NH", "NJ", "NL", "NM", "NS", "NV", "NY", "OH", "OK", "ON", "OR", "PA",
"PR", "QC", "RI", "SC", "SD", "TN", "TX", "UT", "VA", "VT", "WA", "WI", "WV", "WY"),
Count = c(3, 5, 34, 10, 91, 14, 843, 73, 44, 30, 15, 913, 669, 19, 18, 13, 520, 64, 15, 17, 33, 69, 1,
102, 8, 79, 39, 46, 13, 6, 121, 131, 4, 13, 14, 236, 1, 10, 1, 46, 638, 86, 32, 49, 20, 126,
2, 6, 10, 46, 3, 69, 598, 28, 113, 4, 38, 24, 3, 3)
)
# Bar plot
ggplot(state_counts, aes(x = reorder(State, -Count), y = Count, fill = State)) +
geom_bar(stat = "identity") +
coord_flip() +  # Flips for better readability
theme_minimal() +
labs(title = "State/Province Distribution", x = "State/Province", y = "Count") +
theme(legend.position = "none")
library(ggplot2)
library(maps)
library(dplyr)
# Load required libraries
library(ggplot2)
library(reshape2)
# Example dataset (replace with your actual dataset)
# If the probabilities are spread across multiple columns, reshape the data first
datasets <- data.frame(
ID = 1:10,
Probability = c(0.1, 0.3, 0.6, 0.8, 0.4, 0.2, 0.9, 0.7, 0.5, 0.65)
)
# Now we create the heatmap
ggplot(dataset, aes(x = ID, y = 1, fill = Probability)) +
geom_tile() +  # Use geom_tile to create the heatmap effect
scale_fill_gradient(low = "white", high = "blue") +  # Choose colors for low and high values
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +  # Remove y-axis ticks
labs(title = "Probability Heatmap", x = "ID", y = "Probability")
table(dataset$`Lead Source (Accounts)`)
# Load necessary libraries
library(ggplot2)
library(dplyr)
# Assuming the dataset is already loaded
# and the column name is `Lead Source (Accounts)`
# Rename column to a simpler name if preferred
dataset <- dataset %>% rename(lead_source = `Lead Source (Accounts)`)
# Bar Plot for Lead Source Distribution
bar_plot <- ggplot(datasets, aes(x = lead_source)) +
geom_bar(fill = "blue") +
labs(title = "Distribution of Lead Sources", x = "Lead Source", y = "Count") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Pie Chart for Lead Source Proportion
pie_chart <- dataset %>%
count(lead_source) %>%
ggplot(aes(x = "", y = n, fill = lead_source)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y") +
labs(title = "Proportion of Lead Sources") +
theme_void() +
theme(legend.position = "right")
# Box Plot for Lead Counts by Source
# Assuming you have lead counts or can simulate the data
dataset$lead_count <- sample(1:50, nrow(dataset), replace = TRUE)
box_plot <- ggplot(dataset, aes(x = lead_source, y = lead_count)) +
geom_boxplot(fill = "lightblue") +
labs(title = "Lead Counts by Source", x = "Lead Source", y = "Lead Count") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Histogram for Lead Count Distribution
histogram <- ggplot(dataset, aes(x = lead_count)) +
geom_histogram(binwidth = 5, fill = "green", color = "black") +
labs(title = "Distribution of Lead Counts", x = "Lead Count", y = "Frequency") +
theme_minimal()
# Display the plots
print(bar_plot)
print(pie_chart)
print(box_plot)
print(histogram)
#Discussion Module 6
library(ggplot2)
install.packages("usmap")
install.packages("usmap")
library(dplyr)
# Create a lookup table for state abbreviations to full names
state_abbr_to_name <- data.frame(
state_abb = state.abb,
state_name = tolower(state.name) # Convert to lowercase to match map_data
)
# Summarize data by state abbreviation
data_summary <- dataset %>%
group_by(`Mailing State (Accounts)`) %>%
summarise(count = n()) %>%
rename(state_abb = `Mailing State (Accounts)`)  # Rename column for merging
# Convert state abbreviations to full names
data_summary <- left_join(data_summary, state_abbr_to_name, by = "state_abb")
# Load US state map data
states_map <- map_data("state")
# Merge summarized data with map data
map_data_merged <- left_join(states_map, data_summary, by = c("region" = "state_name"))
# Plot choropleth map
ggplot(map_data_merged, aes(x = long, y = lat, group = group, fill = count)) +
geom_polygon(color = "white") +
scale_fill_ccor_matrix <- cor(dataset, use = "complete.obs")  # Handle missing values
table(dataset$`Customer Type`)
table(dataset$`New Customer Type (Deals)`)
# Drop specific columns by name
dataset <- dataset[, !(names(dataset) %in% c("Account Owner.id", "Modified By.id", "Partner Rep.id", "Last Enriched Time", "Lead Sub Source.id.x", "Deal Owner.id", "Lead Sub Source.id.y", "Pipeline", "Overall Sales Duration", "Customer Type"))]
View(dataset)
# Rename specific columns
colnames(dataset)[colnames(dataset) == "Account Owner(Account Owner).id"] <- "Account Owner.id"
colnames(dataset)[colnames(dataset) == "Customer Type(Customer Type)"] <- "Customer Type"
colnames(dataset)[colnames(dataset) == "Created Time(Created Time)"] <- "Created Time"
colnames(dataset)[colnames(dataset) == "Lead Sub Source(Lead Sub Source).id"] <- "Lead Sub Source.id"
colnames(dataset)[colnames(dataset) == "Created Time.y"] <- "Created Time (Accounts)"
colnames(dataset)[colnames(dataset) == "Lead Source.y"] <- "Lead Source (Accounts)"
colnames(dataset)[colnames(dataset) == "Lead Sub Source.y"] <- "Lead Sub Source (Accounts)"
colnames(dataset)[colnames(dataset) == "Created Time.x"] <- "Created Time (Deals)"
colnames(dataset)[colnames(dataset) == "Lead Source.x"] <- "Lead Source (Deals)"
colnames(dataset)[colnames(dataset) == "Lead Sub Source.x"] <- "Lead Sub Source (Deals)"
View(dataset)
#Fill in Blank Cells with 'NA'
library(tidyverse)
# Replace blank cells in specific columns with NA
cols_to_check <- c("Deal Name", "Pipeline", "Stage", "Account Name.id", "Deal Owner",
"Created Time", "Forecast Date", "Lead Source", "Lead Sub Source",
"Account Owner.id", "Customer Type", "Client Inquiry", "Lead Received",
"New Customer Type", "Lead Sub Source.id", "Mailing State",
"Mailing Country", "Amount", "Closing Date", "Probability (%)",
"Proposal Start Date", "Sales Cycle Duration", "Overall Sales Duration")
# Loop through the columns and replace blank cells with NA, considering column type
for (col in cols_to_check) {
# Only apply to character or factor columns
if (is.character(dataset[[col]]) | is.factor(dataset[[col]])) {
dataset[[col]][dataset[[col]] == ''] <- NA
}
}
# Print the modified dataset
print(dataset)
View(dataset)
summary(dataset)
#Merge duplicate columns together
# Check for duplicate column names
duplicated_columns <- names(dataset)[duplicated(names(dataset))]
print(duplicated_columns)
# Load necessary library
library(ggplot2)
# Ensure 'Partner Rep' is treated as a factor to get individual bars for each unique rep
dataset$`Partner Rep` <- as.factor(dataset$`Partner Rep`)
# Create the bar chart
ggplot(dataset, aes(x = `Partner Rep`)) +
geom_bar(fill = "skyblue") +
labs(title = "Total Count for Each Partner Rep", x = "Partner Rep", y = "Total Count") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate labels for readability
#Checking the amount per state
table(dataset$`Mailing State (Deals)`)
state_lookup <- setNames(state.abb, state.name)
# Create a lookup table for state names and their abbreviations
state_lookup <- setNames(state.abb, state.name)
# Edit inaccurate or incomplete values in cells of columns
dataset$`Mailing State (Deals)` <- ifelse(
dataset$`Mailing State (Deals)` %in% state.name,
state_lookup[dataset$`Mailing State (Deals)`],
dataset$`Mailing State (Deals)`
)
table(dataset$`Mailing State (Deals)`)
View(dataset)
sum(is.na(dataset$`Mailing State (Deals)`))
dataset$`Mailing State (Deals)`[dataset$`Mailing State (Deals)` == "--"] <- NA
table(dataset$`Mailing State (Deals)`)
dataset$`Mailing State (Deals)`[dataset$`Mailing State (Deals)` == "No aplicable"] <- NA
table(dataset$`Mailing State (Deals)`)
dataset$`Mailing State (Deals)`[dataset$`Mailing State (Deals)` == "XX"] <- NA
table(dataset$`Mailing State (Deals)`)
View(dataset)
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("United States", "US", "UNITED STATES")] <- "USA"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("CAN")] <- "Canada"
table(dataset$`Mailing Country (Deals)`)
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("AE")] <- "United Arab Emirates"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("AR")] <- "Argentina"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("AU")] <- "Australia"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("Austrailia")] <- "Australia"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("CN")] <- "China"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("CY")] <- "Cyprus"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("GB")] <- "Great Britain"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("HK")] <- "Hong Kong"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("IN")] <- "India"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("IS")] <- "Iceland"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("LB")] <- "Lebanon"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("NO")] <- "Norway"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("PA")] <- "Panama"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("PR")] <- "Puerto Rico"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("RO")] <- "Romania"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("SA")] <- "Saudi Arabia"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("TT")] <- "Trinidad and Tobago"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("TW")] <- "Taiwan"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("UK")] <- "United Kingdom"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("UY")] <- "Uruguay"
table(dataset$`Mailing Country (Deals)`)
View(dataset)
table(dataset$`Forecast Date`)
dataset$`Forecast Date`[dataset$`Forecast Date` == "1899-12-31"] <- NA
table(dataset$`Forecast Date`)
dataset$`Account Type`[dataset$`Account Type` %in% c("Other/Unknown")] <- "Other - Unknown"
table(dataset$`Account Type`)
dataset$`Lead Source (Accounts)`[dataset$`Lead Source (Accounts)` %in% c("Other - Internet")] <- "Internet"
colnames(dataset)[colnames(dataset) == "Account Owner(Account Owner).id"] <- "Account Owner.id"
colnames(dataset)[colnames(dataset) == "Customer Type(Customer Type)"] <- "Customer Type"
colnames(dataset)[colnames(dataset) == "Created Time(Created Time)"] <- "Created Time"
colnames(dataset)[colnames(dataset) == "Lead Sub Source(Lead Sub Source).id"] <- "Lead Sub Source.id"
colnames(dataset)[colnames(dataset) == "Created Time.y"] <- "Created Time (Accounts)"
colnames(dataset)[colnames(dataset) == "Lead Source.y"] <- "Lead Source (Accounts)"
colnames(dataset)[colnames(dataset) == "Lead Sub Source.y"] <- "Lead Sub Source (Accounts)"
colnames(dataset)[colnames(dataset) == "Created Time.x"] <- "Created Time (Deals)"
colnames(dataset)[colnames(dataset) == "Lead Source.x"] <- "Lead Source (Deals)"
colnames(dataset)[colnames(dataset) == "Lead Sub Source.x"] <- "Lead Sub Source (Deals)"
View(dataset)
#Fill in Blank Cells with 'NA'
library(tidyverse)
# Replace blank cells in specific columns with NA
cols_to_check <- c("Deal Name", "Pipeline", "Stage", "Account Name.id", "Deal Owner",
"Created Time", "Forecast Date", "Lead Source", "Lead Sub Source",
"Account Owner.id", "Customer Type", "Client Inquiry", "Lead Received",
"New Customer Type", "Lead Sub Source.id", "Mailing State",
"Mailing Country", "Amount", "Closing Date", "Probability (%)",
"Proposal Start Date", "Sales Cycle Duration", "Overall Sales Duration")
# Loop through the columns and replace blank cells with NA, considering column type
for (col in cols_to_check) {
# Only apply to character or factor columns
if (is.character(dataset[[col]]) | is.factor(dataset[[col]])) {
dataset[[col]][dataset[[col]] == ''] <- NA
}
}
# Print the modified dataset
print(dataset)
View(dataset)
summary(dataset)
#Merge duplicate columns together
# Check for duplicate column names
duplicated_columns <- names(dataset)[duplicated(names(dataset))]
print(duplicated_columns)
# Load necessary library
library(ggplot2)
# Ensure 'Partner Rep' is treated as a factor to get individual bars for each unique rep
dataset$`Partner Rep` <- as.factor(dataset$`Partner Rep`)
# Create the bar chart
ggplot(dataset, aes(x = `Partner Rep`)) +
geom_bar(fill = "skyblue") +
labs(title = "Total Count for Each Partner Rep", x = "Partner Rep", y = "Total Count") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate labels for readability
#Checking the amount per state
table(dataset$`Mailing State (Deals)`)
state_lookup <- setNames(state.abb, state.name)
# Create a lookup table for state names and their abbreviations
state_lookup <- setNames(state.abb, state.name)
# Edit inaccurate or incomplete values in cells of columns
dataset$`Mailing State (Deals)` <- ifelse(
dataset$`Mailing State (Deals)` %in% state.name,
state_lookup[dataset$`Mailing State (Deals)`],
dataset$`Mailing State (Deals)`
)
table(dataset$`Mailing State (Deals)`)
View(dataset)
sum(is.na(dataset$`Mailing State (Deals)`))
dataset$`Mailing State (Deals)`[dataset$`Mailing State (Deals)` == "--"] <- NA
table(dataset$`Mailing State (Deals)`)
dataset$`Mailing State (Deals)`[dataset$`Mailing State (Deals)` == "No aplicable"] <- NA
table(dataset$`Mailing State (Deals)`)
dataset$`Mailing State (Deals)`[dataset$`Mailing State (Deals)` == "XX"] <- NA
table(dataset$`Mailing State (Deals)`)
View(dataset)
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("United States", "US", "UNITED STATES")] <- "USA"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("CAN")] <- "Canada"
table(dataset$`Mailing Country (Deals)`)
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("AE")] <- "United Arab Emirates"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("AR")] <- "Argentina"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("AU")] <- "Australia"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("Austrailia")] <- "Australia"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("CN")] <- "China"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("CY")] <- "Cyprus"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("GB")] <- "Great Britain"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("HK")] <- "Hong Kong"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("IN")] <- "India"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("IS")] <- "Iceland"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("LB")] <- "Lebanon"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("NO")] <- "Norway"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("PA")] <- "Panama"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("PR")] <- "Puerto Rico"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("RO")] <- "Romania"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("SA")] <- "Saudi Arabia"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("TT")] <- "Trinidad and Tobago"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("TW")] <- "Taiwan"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("UK")] <- "United Kingdom"
table(dataset$`Mailing Country (Deals)`)
dataset$`Mailing Country (Deals)`[dataset$`Mailing Country (Deals)` %in% c("UY")] <- "Uruguay"
table(dataset$`Mailing Country (Deals)`)
View(dataset)
table(dataset$`Forecast Date`)
dataset$`Forecast Date`[dataset$`Forecast Date` == "1899-12-31"] <- NA
table(dataset$`Forecast Date`)
dataset$`Account Type`[dataset$`Account Type` %in% c("Other/Unknown")] <- "Other - Unknown"
table(dataset$`Account Type`)
dataset$`Lead Source (Accounts)`[dataset$`Lead Source (Accounts)` %in% c("Other - Internet")] <- "Internet"
dataset$`Lead Source (Accounts)`[dataset$`Lead Source (Accounts)` %in% c("Other - Internet")] <- "Internet"
table(dataset$`Lead Source (Accounts)`)
table(dataset$`Mailing State (Accounts)`)
table(dataset$`Created Time (Deals)`)
table(dataset$`Proposal Sent Date`)
table(dataset$`Created Time (Deals)`)
table(dataset$`Created Time`)
dataset$difference <- dataset$`Created Time (Deals)` - dataset$`Created Time`
summary(dataset$difference)  # Check min, max, mean difference
sum(dataset$difference > 0, na.rm = TRUE)
dataset[dataset$difference > 10, ]  # View rows where the difference is significant
sum(is.na(dataset$`Created Time (Deals)`))
sum(is.na(dataset$`Created Time`))
df[df$`Created Time` != df$`Created Time (Created Time)`, ]
dataset[dataset$`Created Time` != df$`Created Time (Created Time)`, ]
dataset[dataset$`Created Time (Deals)` != dataset$`Created Time`, ]
table(dataset$`Created Time (Deals)`)
table(dataset$`Created Time`)
colnames(dataset)[colnames(dataset) == "Created Time(Created Time)"] <- "Created Time Of Account"
View(dataset)
colnames(dataset)[colnames(dataset) == "Created Time(Created Time)"] <- "Created Time"
colnames(dataset)[colnames(dataset) == "Created Time"] <- "Created Time For Account"
View(dataset)
# Install necessary packages and libraries
install.packages("readxl")
library(readxl)
install.packages(c("dplyr", "psych", "skimr", "Hmisc"))
library(dplyr)
library(psych)
library(skimr)
library(Hmisc)
install.packages(c("dplyr", "psych", "skimr", "Hmisc"))
# Bar plot
ggplot(state_counts, aes(x = reorder(State, -Count), y = Count, fill = State)) +
geom_bar(stat = "identity") +
coord_flip() +  # Flips for better readability
theme_minimal() +
labs(title = "State/Province Distribution", x = "State/Province", y = "Count") +
theme(legend.position = "none")
